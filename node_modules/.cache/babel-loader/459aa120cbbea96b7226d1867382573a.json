{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"/home/lorenzo/projects/werewolf-alpha/werewolf-desktop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/lorenzo/projects/werewolf-alpha/werewolf-desktop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/lorenzo/projects/werewolf-alpha/werewolf-desktop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/lorenzo/projects/werewolf-alpha/werewolf-desktop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _readOnlyError from\"/home/lorenzo/projects/werewolf-alpha/werewolf-desktop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/readOnlyError\";import React,{useEffect}from'react';import axios from'axios';import Web3 from'web3';import Header from'./Components/Layout/Header';import Footer from'./Components/Layout/Footer';import Body from'./Components/Layout/Body';import user from'./funcs/user';import accounting from'./funcs/accounting';function App(){var _React$useState=React.useState({theme:'light',drawer:false}),_React$useState2=_slicedToArray(_React$useState,2),state=_React$useState2[0],setState=_React$useState2[1];// Handle selections in menu drawer\nvar _React$useState3=React.useState('HOME'),_React$useState4=_slicedToArray(_React$useState3,2),selected=_React$useState4[0],setSelected=_React$useState4[1];// Handle signedIn\nvar _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),signedIn=_React$useState6[0],setSignedIn=_React$useState6[1];// Handle eth_account\nvar _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),eth_account=_React$useState8[0],setEth_account=_React$useState8[1];// Handle user logged in from server\nvar _React$useState9=React.useState(),_React$useState10=_slicedToArray(_React$useState9,2),user=_React$useState10[0],setUser=_React$useState10[1];// Handle budget selected\nvar _React$useState11=React.useState(),_React$useState12=_slicedToArray(_React$useState11,2),budget=_React$useState12[0],setBudget=_React$useState12[1];var _React$useState13=React.useState(),_React$useState14=_slicedToArray(_React$useState13,2),web3=_React$useState14[0],setWeb3=_React$useState14[1];// Connect Metamask\n// TODO: set web3 provider from Metamask\nvar connectMetamask=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var accounts,balance,account;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('Connecting Metamask . . .');// Detect Metamask\nif(!(typeof window.ethereum!=='undefined')){_context.next=15;break;}console.log('MetaMask is installed!');_context.next=5;return window.ethereum.request({method:'eth_requestAccounts'});case 5:accounts=_context.sent;console.log(accounts[0]);web3=(_readOnlyError(\"web3\"),new Web3(Web3.givenProvider));// TODO: change balance from wei to eth\n_context.next=10;return web3.eth.getBalance(accounts[0]);case 10:balance=_context.sent;account={address:accounts[0],balance:balance,chainId:window.ethereum.chainId};console.log(account);setEth_account(account);console.log(eth_account);case 15:case\"end\":return _context.stop();}}},_callee);}));return function connectMetamask(){return _ref.apply(this,arguments);};}();// Auth user\nvar authUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,user,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/users/');case 2:res=_context2.sent;user=res.data.user;error=res.data.error;if(error){console.log(error);}if(user===undefined){setUser(null);setSignedIn(false);}else if(user===null){setUser(null);setSignedIn(false);}else if(user){setUser(user);update(user.budgets[0]);setSignedIn(true);}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function authUser(){return _ref2.apply(this,arguments);};}();// Handle updates\nvar update=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(budgetSelected){var _yield$accounting$upd,_budget;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!budgetSelected){_context3.next=8;break;}_context3.next=3;return accounting.update(budgetSelected);case 3:_yield$accounting$upd=_context3.sent;_budget=_yield$accounting$upd.budget;setBudget(_budget);_context3.next=9;break;case 8:if(user){setBudget(user.budgets[0]);}else{setBudget([]);}case 9:case\"end\":return _context3.stop();}}},_callee3);}));return function update(_x){return _ref3.apply(this,arguments);};}();// Handle theme selections\nvar handleChangeTheme=function handleChangeTheme(e){setState(_objectSpread(_objectSpread({},state),{},{theme:e.target.value}));};// Handle menu drawer\nvar toggleDrawer=function toggleDrawer(){setState(_objectSpread(_objectSpread({},state),{},{drawer:!state.drawer}));};useEffect(function(){return authUser();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{setSelected:setSelected,handleChangeTheme:handleChangeTheme,toggleDrawer:toggleDrawer,connectMetamask:connectMetamask,authUser:authUser,theme:state.theme,drawer:state.drawer,signedIn:signedIn,eth_account:eth_account}),/*#__PURE__*/_jsx(Body,{authUser:authUser,selected:selected,user:user,update:update,budget:budget,setBudget:setBudget}),/*#__PURE__*/_jsx(Footer,{})]});}export default App;","map":{"version":3,"sources":["/home/lorenzo/projects/werewolf-alpha/werewolf-desktop/src/App.js"],"names":["React","useEffect","axios","Web3","Header","Footer","Body","user","accounting","App","useState","theme","drawer","state","setState","selected","setSelected","signedIn","setSignedIn","eth_account","setEth_account","setUser","budget","setBudget","web3","setWeb3","connectMetamask","console","log","window","ethereum","request","method","accounts","givenProvider","eth","getBalance","balance","account","address","chainId","authUser","get","res","data","error","undefined","update","budgets","budgetSelected","handleChangeTheme","e","target","value","toggleDrawer"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport axios from 'axios';\nimport Web3 from 'web3';\n\nimport Header from './Components/Layout/Header';\nimport Footer from './Components/Layout/Footer';\nimport Body from './Components/Layout/Body';\n\nimport user from './funcs/user'\nimport accounting from './funcs/accounting'\n\nfunction App() {\n  const [state, setState] = React.useState({\n    theme: 'light',\n    drawer: false,\n  });\n  // Handle selections in menu drawer\n  const [selected, setSelected] = React.useState('HOME');\n  // Handle signedIn\n  const [signedIn, setSignedIn] = React.useState(false);\n  // Handle eth_account\n  const [eth_account, setEth_account] = React.useState();\n  // Handle user logged in from server\n  const [user, setUser] = React.useState();\n  // Handle budget selected\n  const [budget, setBudget] = React.useState()\n\n  const [web3, setWeb3] = React.useState();\n\n  // Connect Metamask\n  // TODO: set web3 provider from Metamask\n  const connectMetamask = async () => {\n    console.log('Connecting Metamask . . .');\n    // Detect Metamask\n    if (typeof window.ethereum !== 'undefined') {\n      console.log('MetaMask is installed!');\n      const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n      console.log(accounts[0]);\n      web3 = new Web3(Web3.givenProvider);\n      // TODO: change balance from wei to eth\n      let balance = await web3.eth.getBalance(accounts[0]);\n      let account = {\n        address: accounts[0],\n        balance,\n        chainId: window.ethereum.chainId\n      }\n      console.log(account);\n      setEth_account(account);\n      console.log(eth_account);\n    }\n    // TODO: else pop up with link to donwload metamask and tutorials\n  }\n\n  // Auth user\n  const authUser = async () => {\n    const res = await axios.get('/users/');\n    const { user } = res.data;\n    const { error } = res.data;\n    if (error) {\n      console.log(error);\n    }\n    if(user === undefined) {\n      setUser(null);\n      setSignedIn(false);\n    }else if (user === null) {\n      setUser(null);\n      setSignedIn(false);\n    }else if (user) {\n      setUser(user);\n      update(user.budgets[0])\n      setSignedIn(true);\n    }\n  }\n\n  // Handle updates\n  const update = async (budgetSelected) => {\n    if (budgetSelected) {\n      let { budget } = await accounting.update(budgetSelected)\n      setBudget(budget)\n    } else  if (user) {\n      setBudget(user.budgets[0])      \n    } else {\n      setBudget([])\n    }\n  }\n\n  // Handle theme selections\n  const handleChangeTheme = (e) => {\n    setState({...state, theme: e.target.value});\n  };\n\n  // Handle menu drawer\n  const toggleDrawer = () => {\n    setState({...state, drawer: !state.drawer});\n  }\n\n  useEffect(() => authUser(), []);\n\n  return (\n    <div className=\"App\">\n      <Header\n        setSelected={setSelected}\n        handleChangeTheme={handleChangeTheme}\n        toggleDrawer={toggleDrawer}\n        connectMetamask={connectMetamask}\n        authUser={authUser}\n        theme={state.theme}\n        drawer={state.drawer}\n        signedIn={signedIn}\n        eth_account={eth_account}\n      />        \n      <Body\n        authUser={authUser}\n        selected={selected}\n        user={user}\n        update={update}\n        budget={budget}\n        setBudget={setBudget}\n      />\n      <Footer></Footer>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}